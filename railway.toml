[build]
builder = "NIXPACKS"
buildCommand = "npm install && npx vite build && mkdir -p dist && cp server/railway-fixed.cjs dist/server.cjs && cp -r dist/public dist/ && echo 'Railway build complete'"

[deploy]
startCommand = "NODE_ENV=production node dist/server.cjs"
healthcheckPath = "/health"
healthcheckTimeout = 300
healthcheckInterval = 30
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

[variables]
NODE_ENV = "production"